(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2055b44b"],{"43f6":function(t,e,a){"use strict";a("4d2e")},4509:function(t,e,a){"use strict";a("e081")},"4d2e":function(t,e,a){},"6da0":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"container"},[e("div",{staticClass:"widget"},[e("div",{staticClass:"tool-bar"},[t._v("答题记录")]),t._v(" "),e("div",{staticClass:"search-group"},[e("el-form",{attrs:{inline:"",size:"mini"}},[e("el-form-item",{staticClass:"el-form-item",attrs:{label:"分类"}},[e("el-select",{staticClass:"select",attrs:{clearable:""},model:{value:t.listQuery.q_type,callback:function(e){t.$set(t.listQuery,"q_type",e)},expression:"listQuery.q_type"}},t._l(t.qType,(function(t){return e("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1),t._v(" "),e("el-form-item",{staticClass:"el-form-item",attrs:{label:"状态"}},[e("el-select",{staticClass:"select",attrs:{clearable:""},model:{value:t.listQuery.status,callback:function(e){t.$set(t.listQuery,"status",e)},expression:"listQuery.status"}},t._l(t.statusList,(function(t){return e("el-option",{key:t[0],attrs:{label:t[1],value:t[0]}})})),1)],1),t._v(" "),e("el-form-item",{staticClass:"el-form-item",attrs:{label:"用户名"}},[e("el-input",{attrs:{placeholder:"请输入"},model:{value:t.listQuery.username,callback:function(e){t.$set(t.listQuery,"username",e)},expression:"listQuery.username"}})],1),t._v(" "),e("el-form-item",{staticClass:"el-form-item",attrs:{label:"题目"}},[e("el-input",{attrs:{placeholder:"请输入"},model:{value:t.listQuery.question,callback:function(e){t.$set(t.listQuery,"question",e)},expression:"listQuery.question"}})],1),t._v(" "),e("el-form-item",[e("el-button",{staticStyle:{margin:"0 5px"},attrs:{size:"mini",type:"primary"},on:{click:t.getData}},[t._v("查询")])],1)],1)],1),t._v(" "),e("div",{staticClass:"widget-content"},[e("div",{staticClass:"page-container"},[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{size:"mini",data:t.data,stripe:"","highlight-current-row":""}},[e("el-table-column",{attrs:{align:"center",label:"提交人",prop:"username",width:"120"}}),t._v(" "),e("el-table-column",{attrs:{align:"center",label:"题目",prop:"question.name",width:"220"}}),t._v(" "),e("el-table-column",{attrs:{align:"center",label:"类别",prop:"question.type",width:"100"}}),t._v(" "),e("el-table-column",{attrs:{align:"center",label:"得分",prop:"score",width:"100"}}),t._v(" "),e("el-table-column",{attrs:{align:"center",label:"Flag",prop:"flag"}}),t._v(" "),e("el-table-column",{attrs:{align:"center",label:"状态",prop:"has_solved",width:"100"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-tag",{attrs:{effect:"dark",type:t.statusType[a.row.status]}},[t._v(t._s(a.row.status_name))])]}}])}),t._v(" "),e("el-table-column",{attrs:{align:"center",label:"提交IP",prop:"ip",width:"150"}}),t._v(" "),e("el-table-column",{attrs:{align:"center",label:"提交时间",prop:"date_created",width:"150"}})],1)],1),t._v(" "),e("div",{staticClass:"pagination-container"},[e("el-pagination",{attrs:{"current-page":t.listQuery.page,"page-size":t.listQuery.page_size,"page-sizes":[10,20,30,50],total:t.total,background:"",layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)])])])},s=[],l=a("e876"),n=a("ee36"),r={name:"Question",components:{questionItem:n["a"]},data:function(){return{qType:[],statusList:[],statusType:["","primary","info","danger","warning"],total:0,listQuery:{has_solved:null,capture:null,page_size:10,q_type:null},loading:!1,chiData:{},showAddQuestion:!1,data:[],rid:null,captureName:null}},created:function(){this.getData(),this.getOptions()},methods:{getOptions:function(){var t=this;l["a"].get("/api/admin/ctf/answers/status_list").then((function(e){t.statusList=e.data})),l["a"].get("/api/admin/ctf/question/type").then((function(e){t.qType=e.results}))},handleSizeChange:function(t){this.listQuery.page_size=t,this.getData()},handleCurrentChange:function(t){this.listQuery.page=t,this.getData()},getData:function(){var t=this;this.loading=!0,l["a"].get("/api/admin/ctf/answers",this.listQuery).then((function(e){t.data=e.data,t.total=e.total,t.loading=!1}))},handleAdd:function(){this.showAddQuestion=!1,this.getData()},destroyItem:function(t){var e=this;this.chiData=t,l["a"].post("/api/manager/ctf/solved/".concat(row.id,"/to_void/")).then((function(t){e.$message({message:"已作废",type:"success"}),e.getData()}))},switchActive:function(t,e){var a=this;l["a"].post("/api/manager/ctf/question/".concat(e.id,"/active/"),{active:t}).then((function(t){a.$message({message:"修改成功",type:"success",duration:2e3})}))}}},o=r,c=(a("43f6"),a("2877")),u=Object(c["a"])(o,i,s,!1,null,null,null);e["default"]=u.exports},e081:function(t,e,a){},ee36:function(t,e,a){"use strict";a("7f7f");var i=function(){var t=this,e=t._self._c;return t.show?e("el-dialog",{attrs:{"before-close":t.cancel,"show-close":!0,title:t.form.id?"编辑题目":"添加题目",visible:t.show,center:"","destroy-on-close":"","close-on-click-modal":!1,width:"40%"},on:{"update:visible":function(e){t.show=e},close:t.cancel}},[e("el-form",{ref:"form",staticClass:"form",attrs:{model:t.form,"label-width":"80px",size:"mini",rules:t.rules}},[e("el-form-item",{attrs:{label:"名称",prop:"name"}},[e("el-input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t._v(" "),e("el-form-item",{attrs:{label:"类别",prop:"type"}},[e("el-select",{model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},t._l(t.options,(function(t){return e("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1),t._v(" "),e("el-form-item",{staticClass:"block-input",attrs:{label:"是否激活"}},[e("el-switch",{model:{value:t.form.active,callback:function(e){t.$set(t.form,"active",e)},expression:"form.active"}})],1),t._v(" "),e("el-form-item",{staticClass:"block-input",attrs:{label:"动态Flag"}},[e("el-switch",{on:{change:t.changeActiveFlag},model:{value:t.form.active_flag,callback:function(e){t.$set(t.form,"active_flag",e)},expression:"form.active_flag"}})],1),t._v(" "),t.form.active_flag?e("el-form-item",{staticClass:"block-input",attrs:{required:"",label:"环境",prop:"resource_id"}},[e("el-select",{attrs:{clearable:""},model:{value:t.form.resource_id,callback:function(e){t.$set(t.form,"resource_id",e)},expression:"form.resource_id"}},t._l(t.resource_list,(function(t){return e("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1):e("el-form-item",{staticClass:"block-input",attrs:{label:"Flag",prop:"flag"}},[e("el-row",[e("el-col",{attrs:{span:20}},[e("el-input",{model:{value:t.form.flag,callback:function(e){t.$set(t.form,"flag",e)},expression:"form.flag"}})],1)],1)],1),t._v(" "),e("el-form-item",{attrs:{label:"描述",prop:"desc"}},[e("el-input",{attrs:{type:"textarea"},model:{value:t.form.desc,callback:function(e){t.$set(t.form,"desc",e)},expression:"form.desc"}})],1),t._v(" "),e("el-row",[e("el-col",{attrs:{span:8}},[e("el-form-item",{attrs:{label:"积分",required:""}},[e("el-input",{attrs:{type:"number"},model:{value:t.form.score,callback:function(e){t.$set(t.form,"score",e)},expression:"form.score"}})],1)],1)],1),t._v(" "),e("el-form-item",{attrs:{label:"附件"}},[e("input",{ref:"inputer",staticStyle:{display:"none"},attrs:{id:"inputFile",type:"file"},on:{change:t.handleFile}}),t._v(" "),e("el-button",{attrs:{type:"primary"},on:{click:t.handleFileClick}},[t._v("上传")]),t._v(" "),e("div",{staticStyle:{width:"300px"}},t._l(t.attachment,(function(a,i){return e("div",{staticClass:"file-item"},[e("a",{attrs:{href:a.filename,target:"_blank"}},[t._v(t._s(a.filename))]),t._v(" "),e("i",{staticClass:"el-icon-close",on:{click:function(e){return t.removeFile(i)}}})])})),0)],1)],1),t._v(" "),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{size:"mini"},on:{click:t.cancel}},[t._v("取 消")]),t._v(" "),e("el-button",{attrs:{size:"mini",type:"primary"},on:{click:t.submit}},[t._v("确 定")])],1)],1):t._e()},s=[],l=a("e876"),n={name:"addQuestion",props:{show:{type:Boolean},data:{type:Object}},data:function(){return{resource_list:[],hostOption:[],imageOption:[],capture:null,fileChange:!1,options:[],attachment:[],form:{attachment:[],resource_id:null,name:null,flag:null,desc:null,score:null,type:null,active:!0,active_flag:!1},rules:{name:[{required:!0,message:"请输入名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],type:[{required:!0,message:"请选择类别",trigger:"blur"}],desc:[{required:!0,message:"请填写描述信息",trigger:"blur"},{min:3,max:200,message:"长度在 3 到 200 个字符",trigger:"blur"}],flag:[{required:!0,message:"请输入flag",trigger:"blur"},{min:3,max:64,message:"长度在 3 到 64 个字符",trigger:"blur"}]}}},created:function(){this.getOptions(),this.getResourceList(),this.data.id&&(this.form.id=this.data.id,this.form.name=this.data.name,this.form.flag=this.data.flag,this.form.desc=this.data.desc,this.form.active_flag=this.data.active_flag,this.form.type=this.data.type,this.form.active=this.data.active,this.form.score=this.data.score,this.form.resource_id=this.data.resource_id,this.form.active&&this.getDockerHost(),this.data.attachment.length>0&&(this.attachment=this.form.attachment))},methods:{getOptions:function(){var t=this;l["a"].get("/api/admin/ctf/question/type").then((function(e){t.options=e.data}))},getResourceList:function(){var t=this;l["a"].get("/api/admin/docker/resource",{page_size:99999,status:1}).then((function(e){t.resource_list=e.data}))},getDockerHost:function(){var t=this;l["a"].get("/api/admin/docker/host",{page_size:999}).then((function(e){t.hostOption=e.data}))},cancel:function(){this.$emit("action",!1)},submit:function(){var t=this;this.form.attachment=[];for(var e=0;e<this.attachment.length;e++)this.form.attachment.push(this.attachment[e].uuid);this.$refs["form"].validate((function(e){e?t.form.id?l["a"].put("/api/admin/ctf/question/".concat(t.form.id),t.form).then((function(e){t.$emit("action",!0),t.$message({message:"提交成功",type:"success"})})).catch((function(t){})):l["a"].post("/api/admin/ctf/question",t.form).then((function(e){t.$emit("action",!0)})).catch((function(t){})):console.log("表单验证失败")}))},handleFileClick:function(){document.getElementById("inputFile").click()},changeActiveFlag:function(t){t&&this.getDockerHost()},removeFile:function(t){this.fileChange=!0,this.attachment.splice(t,1)},handleFile:function(){var t=this,e=this.$refs.inputer,a=e.files[0],i=new FormData;i.append("file",a),l["a"].post("/api/admin/ctf/upload",i).then((function(e){t.fileChange=!0;var a=e.uuid,i=e.filename;t.attachment.push({uuid:a,filename:i})}))}}},r=n,o=(a("4509"),a("2877")),c=Object(o["a"])(r,i,s,!1,null,"32f808a9",null);e["a"]=c.exports}}]);