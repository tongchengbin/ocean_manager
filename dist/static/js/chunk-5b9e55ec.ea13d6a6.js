(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5b9e55ec"],{"0071":function(t,e,a){"use strict";a.r(e);a("386d");var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"container"},[t.showAddQuestion?e("questionItem",{attrs:{data:t.chiData,show:t.showAddQuestion},on:{action:t.handleAdd}}):t._e(),t._v(" "),e("div",{staticClass:"widget"},[e("div",{staticClass:"tool-bar"},[t._v("题库")]),t._v(" "),e("div",{staticClass:"search-group"},[e("el-form",{attrs:{inline:"",size:"mini"}},[e("el-form-item",{staticClass:"el-form-item",attrs:{label:"分类"}},[e("el-select",{staticClass:"select",attrs:{clearable:""},model:{value:t.listQuery.subject,callback:function(e){t.$set(t.listQuery,"subject",e)},expression:"listQuery.subject"}},t._l(t.qType,(function(t){return e("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1),t._v(" "),e("el-form-item",[e("el-input",{attrs:{placeholder:"题目名称"},model:{value:t.listQuery.search,callback:function(e){t.$set(t.listQuery,"search",e)},expression:"listQuery.search"}})],1),t._v(" "),e("el-form-item",[e("el-button",{attrs:{size:"mini",type:"primary"},on:{click:t.getList}},[t._v("查询")])],1),t._v(" "),e("el-form-item",[e("el-button",{attrs:{size:"mini",type:"primary"},on:{click:t.handleCreate}},[t._v("添加")])],1)],1)],1),t._v(" "),e("div",{staticClass:"widget-content"},[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{size:"mini",fit:"","highlight-current-row":"",stripe:"",data:t.listData}},[e("el-table-column",{attrs:{align:"center",label:"ID",prop:"id",width:"80"}}),t._v(" "),e("el-table-column",{attrs:{align:"center",label:"标题",prop:"name",width:"220"}}),t._v(" "),e("el-table-column",{attrs:{align:"center",label:"类别",prop:"type",width:"180"}}),t._v(" "),e("el-table-column",{attrs:{align:"center",label:"是否启用",prop:"name",width:"80"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-switch",{on:{change:function(e){return t.switchActive(e,a.row)}},model:{value:a.row.active,callback:function(e){t.$set(a.row,"active",e)},expression:"scope.row.active"}})]}}])}),t._v(" "),e("el-table-column",{attrs:{align:"center",label:"是否动态",width:"80"},scopedSlots:t._u([{key:"default",fn:function(a){return[a.row.active_flag?e("el-tag",{attrs:{effect:"dark"}},[t._v("是")]):e("el-tag",{attrs:{effect:"dark",type:"warning"}},[t._v("否")])]}}])}),t._v(" "),e("el-table-column",{attrs:{align:"center",label:"积分",prop:"score",width:"80"}}),t._v(" "),e("el-table-column",{attrs:{align:"center",label:"环境",prop:"resource_name",width:"180"}}),t._v(" "),e("el-table-column",{attrs:{align:"center",label:"描述",prop:"desc","show-overflow-tooltip":""}}),t._v(" "),e("el-table-column",{attrs:{align:"center",label:"操作",width:"160"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.editHandle(a.row)}}},[t._v("编辑")]),t._v(" "),e("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(e){return t.deleteHandle(a.row)}}},[t._v("删除")])]}}])})],1),t._v(" "),e("div",{staticClass:"pagination-container"},[e("el-pagination",{attrs:{"current-page":t.listQuery.page,"page-size":t.listQuery.page_size,"page-sizes":[10,20,30,50],total:t.total,background:"",layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1)])],1)},n=[],s=a("e876"),l=a("ee36"),o={name:"Question",components:{questionItem:l["a"]},data:function(){return{qType:[],listQuery:{page:1,page_size:10,subject:null,search:null},loading:!1,chiData:{},showAddQuestion:!1,total:0,listData:[],rid:null,captureName:null}},created:function(){this.getList(),this.getOptions()},methods:{getOptions:function(){var t=this;s["a"].get("/api/admin/ctf/question/type").then((function(e){t.qType=e.results}))},getList:function(){var t=this;this.loading=!0,s["a"].get("/api/admin/ctf/question",this.listQuery).then((function(e){t.listData=e.results,t.loading=!1,t.total=e.total})).catch((function(t){}))},handleSizeChange:function(t){this.listQuery.page_size=t,this.getList()},handleCurrentChange:function(t){this.listQuery.page=t,this.getList()},handleCreate:function(){this.chiData={capture:this.rid},this.showAddQuestion=!0},editHandle:function(t){this.chiData=t,this.showAddQuestion=!0},deleteHandle:function(t){var e=this;s["a"].delete("/api/admin/ctf/question/".concat(t.id)).then((function(t){e.$message({message:"删除成功",type:"success"}),e.getList()}))},handleAdd:function(t){this.showAddQuestion=!1,t&&this.getList()},switchActive:function(t,e){var a=this;s["a"].put("/api/admin/ctf/question/".concat(e.id),{active:t}).then((function(t){a.$message({message:"修改成功",type:"success",duration:2e3})}))}}},r=o,c=(a("def3"),a("2877")),u=Object(c["a"])(r,i,n,!1,null,"00f99a82",null);e["default"]=u.exports},4509:function(t,e,a){"use strict";a("e081")},"636c":function(t,e,a){},def3:function(t,e,a){"use strict";a("636c")},e081:function(t,e,a){},ee36:function(t,e,a){"use strict";a("7f7f");var i=function(){var t=this,e=t._self._c;return t.show?e("el-dialog",{attrs:{"before-close":t.cancel,"show-close":!0,title:t.form.id?"编辑题目":"添加题目",visible:t.show,center:"","destroy-on-close":"","close-on-click-modal":!1,width:"40%"},on:{"update:visible":function(e){t.show=e},close:t.cancel}},[e("el-form",{ref:"form",staticClass:"form",attrs:{model:t.form,"label-width":"80px",size:"mini",rules:t.rules}},[e("el-form-item",{attrs:{label:"名称",prop:"name"}},[e("el-input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t._v(" "),e("el-form-item",{attrs:{label:"类别",prop:"type"}},[e("el-select",{model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},t._l(t.options,(function(t){return e("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1),t._v(" "),e("el-form-item",{staticClass:"block-input",attrs:{label:"是否激活"}},[e("el-switch",{model:{value:t.form.active,callback:function(e){t.$set(t.form,"active",e)},expression:"form.active"}})],1),t._v(" "),e("el-form-item",{staticClass:"block-input",attrs:{label:"动态Flag"}},[e("el-switch",{on:{change:t.changeActiveFlag},model:{value:t.form.active_flag,callback:function(e){t.$set(t.form,"active_flag",e)},expression:"form.active_flag"}})],1),t._v(" "),t.form.active_flag?e("el-form-item",{staticClass:"block-input",attrs:{required:"",label:"环境",prop:"resource_id"}},[e("el-select",{attrs:{clearable:""},model:{value:t.form.resource_id,callback:function(e){t.$set(t.form,"resource_id",e)},expression:"form.resource_id"}},t._l(t.resource_list,(function(t){return e("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1):e("el-form-item",{staticClass:"block-input",attrs:{label:"Flag",prop:"flag"}},[e("el-row",[e("el-col",{attrs:{span:20}},[e("el-input",{model:{value:t.form.flag,callback:function(e){t.$set(t.form,"flag",e)},expression:"form.flag"}})],1)],1)],1),t._v(" "),e("el-form-item",{attrs:{label:"描述",prop:"desc"}},[e("el-input",{attrs:{type:"textarea"},model:{value:t.form.desc,callback:function(e){t.$set(t.form,"desc",e)},expression:"form.desc"}})],1),t._v(" "),e("el-row",[e("el-col",{attrs:{span:8}},[e("el-form-item",{attrs:{label:"积分",required:""}},[e("el-input",{attrs:{type:"number"},model:{value:t.form.score,callback:function(e){t.$set(t.form,"score",e)},expression:"form.score"}})],1)],1)],1),t._v(" "),e("el-form-item",{attrs:{label:"附件"}},[e("input",{ref:"inputer",staticStyle:{display:"none"},attrs:{id:"inputFile",type:"file"},on:{change:t.handleFile}}),t._v(" "),e("el-button",{attrs:{type:"primary"},on:{click:t.handleFileClick}},[t._v("上传")]),t._v(" "),e("div",{staticStyle:{width:"300px"}},t._l(t.attachment,(function(a,i){return e("div",{staticClass:"file-item"},[e("a",{attrs:{href:a.filename,target:"_blank"}},[t._v(t._s(a.filename))]),t._v(" "),e("i",{staticClass:"el-icon-close",on:{click:function(e){return t.removeFile(i)}}})])})),0)],1)],1),t._v(" "),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{size:"mini"},on:{click:t.cancel}},[t._v("取 消")]),t._v(" "),e("el-button",{attrs:{size:"mini",type:"primary"},on:{click:t.submit}},[t._v("确 定")])],1)],1):t._e()},n=[],s=a("e876"),l={name:"addQuestion",props:{show:{type:Boolean},data:{type:Object}},data:function(){return{resource_list:[],hostOption:[],imageOption:[],capture:null,fileChange:!1,options:[],attachment:[],form:{attachment:[],resource_id:null,name:null,flag:null,desc:null,score:null,type:null,active:!0,active_flag:!1},rules:{name:[{required:!0,message:"请输入名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],type:[{required:!0,message:"请选择类别",trigger:"blur"}],desc:[{required:!0,message:"请填写描述信息",trigger:"blur"},{min:3,max:200,message:"长度在 3 到 200 个字符",trigger:"blur"}],flag:[{required:!0,message:"请输入flag",trigger:"blur"},{min:3,max:64,message:"长度在 3 到 64 个字符",trigger:"blur"}]}}},created:function(){this.getOptions(),this.getResourceList(),this.data.id&&(this.form.id=this.data.id,this.form.name=this.data.name,this.form.flag=this.data.flag,this.form.desc=this.data.desc,this.form.active_flag=this.data.active_flag,this.form.type=this.data.type,this.form.active=this.data.active,this.form.score=this.data.score,this.form.resource_id=this.data.resource_id,this.form.active&&this.getDockerHost(),this.data.attachment.length>0&&(this.attachment=this.form.attachment))},methods:{getOptions:function(){var t=this;s["a"].get("/api/admin/ctf/question/type").then((function(e){t.options=e.data}))},getResourceList:function(){var t=this;s["a"].get("/api/admin/docker/resource",{page_size:99999,status:1}).then((function(e){t.resource_list=e.data}))},getDockerHost:function(){var t=this;s["a"].get("/api/admin/docker/host",{page_size:999}).then((function(e){t.hostOption=e.data}))},cancel:function(){this.$emit("action",!1)},submit:function(){var t=this;this.form.attachment=[];for(var e=0;e<this.attachment.length;e++)this.form.attachment.push(this.attachment[e].uuid);this.$refs["form"].validate((function(e){e?t.form.id?s["a"].put("/api/admin/ctf/question/".concat(t.form.id),t.form).then((function(e){t.$emit("action",!0),t.$message({message:"提交成功",type:"success"})})).catch((function(t){})):s["a"].post("/api/admin/ctf/question",t.form).then((function(e){t.$emit("action",!0)})).catch((function(t){})):console.log("表单验证失败")}))},handleFileClick:function(){document.getElementById("inputFile").click()},changeActiveFlag:function(t){t&&this.getDockerHost()},removeFile:function(t){this.fileChange=!0,this.attachment.splice(t,1)},handleFile:function(){var t=this,e=this.$refs.inputer,a=e.files[0],i=new FormData;i.append("file",a),s["a"].post("/api/admin/ctf/upload",i).then((function(e){t.fileChange=!0;var a=e.uuid,i=e.filename;t.attachment.push({uuid:a,filename:i})}))}}},o=l,r=(a("4509"),a("2877")),c=Object(r["a"])(o,i,n,!1,null,"32f808a9",null);e["a"]=c.exports}}]);