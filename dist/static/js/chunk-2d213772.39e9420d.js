(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d213772"],{ad92:function(e,t,i){"use strict";i.r(t);i("7f7f"),i("386d");var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"container"},[t("div",{staticClass:"widget"},[t("div",{staticClass:"tool-bar"},[e._v("资源中心")]),e._v(" "),t("div",{staticClass:"search-group"},[t("el-input",{staticStyle:{width:"200px"},attrs:{size:"mini",placeholder:"名称"},model:{value:e.listQuery.search,callback:function(t){e.$set(e.listQuery,"search",t)},expression:"listQuery.search"}}),e._v(" "),t("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.getList()}}},[e._v("查询")]),e._v(" "),t("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.handleCreate}},[e._v("添加")]),e._v(" "),t("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.handleSyncDockerhub}},[e._v("同步Docker仓库资源")])],1),e._v(" "),t("div",{staticClass:"widget-content"},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{fit:"","highlight-current-row":"",stripe:"",size:"mini",data:e.list}},[t("el-table-column",{attrs:{label:"名称",prop:"name",align:"center"}}),e._v(" "),t("el-table-column",{attrs:{label:"镜像",prop:"image",width:"250px",align:"center"}}),e._v(" "),t("el-table-column",{attrs:{label:"资源类型",prop:"resource_type",width:"150px",align:"center"}}),e._v(" "),t("el-table-column",{attrs:{label:"加载类型",prop:"docker_type_name",width:"150px",align:"center"}}),e._v(" "),t("el-table-column",{attrs:{label:"描述",prop:"description",width:"150px",align:"center"}}),e._v(" "),t("el-table-column",{attrs:{width:"180px",align:"center",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(i){return[0===i.row.status?t("el-tag",[e._v("初始化")]):e._e(),e._v(" "),1===i.row.status?t("el-tag",[e._v("已编译")]):e._e(),e._v(" "),2===i.row.status?t("el-tag",[e._v("编译失败")]):e._e()]}}])}),e._v(" "),t("el-table-column",{attrs:{align:"center",label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-button",{attrs:{loading:e.loading_build,type:"primary",size:"mini"},on:{click:function(t){return e.handleBuild(i.row.id)}}},[e._v("编译")]),e._v(" "),t("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(t){return e.handleDelete(i.row.id)}}},[e._v("删除")])]}}])})],1),e._v(" "),t("div",{staticClass:"pagination-container"},[t("el-pagination",{attrs:{background:"","current-page":e.listQuery.page,"page-sizes":[10,20,30,50],"page-size":e.listQuery.page_size,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)]),e._v(" "),t("el-dialog",{attrs:{visible:e.centerDialogVisible,title:"添加资源",width:"30%",center:""},on:{"update:visible":function(t){e.centerDialogVisible=t}}},[t("el-form",{attrs:{size:"mini"}},[t("el-form-item",{attrs:{label:"资源名称",docker_type_list:""}},[t("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"资源类型",required:""}},[t("el-select",{attrs:{size:"mini"},model:{value:e.form.resource_type,callback:function(t){e.$set(e.form,"resource_type",t)},expression:"form.resource_type"}},e._l(e.resource_type_list,(function(e){return t("el-option",{key:e.id,attrs:{label:e.label,value:e.id}})})),1)],1),e._v(" "),t("el-form-item",{attrs:{label:"加载类型",required:""}},[t("el-select",{attrs:{size:"mini"},model:{value:e.form.docker_type,callback:function(t){e.$set(e.form,"docker_type",t)},expression:"form.docker_type"}},e._l(e.docker_type_list,(function(e){return t("el-option",{key:e.id,attrs:{label:e.label,value:e.id}})})),1)],1),e._v(" "),t("el-form-item",{attrs:{label:"镜像名称"}},[t("el-input",{model:{value:e.form.image,callback:function(t){e.$set(e.form,"image",t)},expression:"form.image"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"描述"}},[t("el-input",{model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1)],1),e._v(" "),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"mini"},on:{click:function(t){e.centerDialogVisible=!1}}},[e._v("取 消")]),e._v(" "),t("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.handleSubmit}},[e._v("提交")])],1)],1),e._v(" "),t("docker_resource_sync",{attrs:{open:e.syncDialog},on:{close:e.handleSyncClose}})],1)},a=[],l=i("b775"),s=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{width:"600px",visible:e.open,title:"资源同步"},on:{"update:visible":function(t){e.open=t}}},[t("el-form",[t("el-alert",{attrs:{title:"如果github地址无法访问请自行配置代理或克隆文件至其他站点!",type:"info",closable:!1}}),e._v(" "),t("el-form-item",{attrs:{required:"",label:"同步地址"}},[t("el-input",{attrs:{size:"mini"},model:{value:e.form.url,callback:function(t){e.$set(e.form,"url",t)},expression:"form.url"}})],1)],1),e._v(" "),t("div",{attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.$emit("close",!1)}}},[e._v("取消")]),e._v(" "),t("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.submit}},[e._v(e._s(e.form.id?"更新":"提交"))])],1)],1)},o=[],r={name:"docker_resource_sync",props:{open:Boolean},data:function(){return{form:{url:"https://raw.githubusercontent.com/tongchengbin/ctfdb/main/resources.yaml"}}},methods:{submit:function(){var e=this;l["a"].post("/api/admin/docker/resource/sync",this.form).then((function(t){e.$message({message:"同步成功",type:"success"}),e.$emit("close")})).catch((function(e){}))}}},c=r,u=i("2877"),d=Object(u["a"])(c,s,o,!1,null,"45b17b4e",null),m=d.exports,p={name:"compose_db",components:{docker_resource_sync:m},data:function(){return{loading_build:!1,syncDialog:!1,docker_type_list:[{label:"远程镜像",id:1}],resource_type_list:[{label:"CTF",id:"CTF"}],form:{resource_type:"CTF",docker_type:1},centerDialogVisible:!1,listQuery:{},listLoading:!1,list:[],total:0}},created:function(){this.getList()},methods:{getList:function(){var e=this;l["a"].get("/api/admin/docker/resource").then((function(t){var i=t.data,n=t.total;console.log(i,n),e.list=i,e.total=n}))},handleCreate:function(){this.centerDialogVisible=!0},handleSyncDockerhub:function(){this.syncDialog=!0},handleBuild:function(e){var t=this;this.loading_build=!0,l["a"].post("/api/admin/docker/resource/".concat(e,"/build")).then((function(e){t.loading_build=!1,t.$message({message:"编译完成",type:"success"}),t.getList()}))},handleDelete:function(e){var t=this;l["a"].delete("/api/admin/docker/resource/".concat(e)).then((function(e){t.$message({message:"删除成功",type:"success"}),t.getList()}))},handleSubmit:function(){var e=this;l["a"].post("/api/admin/docker/resource",this.form).then((function(t){e.$message({message:"添加成功",type:"success"}),e.form={},e.centerDialogVisible=!1,e.getList()}))},handleSizeChange:function(e){this.listQuery.page_size=e,this.fetchData()},handleCurrentChange:function(e){this.listQuery.page=e,this.fetchData()},handleSyncClose:function(){this.syncDialog=!1,this.getList()}}},f=p,_=Object(u["a"])(f,n,a,!1,null,"5e89dd4a",null);t["default"]=_.exports}}]);